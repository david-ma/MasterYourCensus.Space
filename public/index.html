<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>Master Your Census</title>

<style>

body {
	background-color: #eee;
}

.page {
	background-color: #fff;
}

header {
	width: 100%;
	height: 200px;
	background: #333e52;
}
header .blur_background {
	height: 200px;
	width: 100%;
	position: absolute;
  background: url("/images/census.jpg");
  background-size: cover;
	background-position: 50% 60%;
}
footer {
	width: 100%;
	height: 50px;
	background: #ddd;
	position: fixed;
	bottom: 0;
}

.mask {
	height: 100%;
	background: linear-gradient(rgba(0,0,0,0),rgba(0,0,0,0.3), rgba(0,0,0,0.5));
}

header .container {
	padding-top: 100px;
}

header h1 {
	font-size: 60px;
	color: #eee;
	margin: 0;
}
header h2 {
	font-size: 30px;
	color: #eee;
	margin: 0;
}

#answers a {
	padding: 5px;
	margin: 5px;
	float: left;




	color: #FFF;
	background-color: #0095ff;
	border-color: #07c;
	box-shadow: inset 0 1px 0 #66bfff
}

#answers a:hover,
#answers a:focus,
#answers a:active {
	color: rgba(255,255,255,0.9);
	background-color: #07c;
	border-color: #005999;
	box-shadow: inset 0 1px 0 #3af;
}

#gamePane {
	background: rgba(0,0,0,0.1);
}
#quizStuff {
	padding-left: 0;
	/*background: rgba(0,0,0,0.1);*/
}

</style>
</head>
<body>
	<header>
		<div class="blur_background">
			<div class="mask"></div>
		</div>
		<div class="container">
			<div class="row">
				<div class="col-xs-12">
					<h1>Master Your Census</h1>
					<h2>Category: <span id="category">All</span> Location: <span id="location">All</span></h2>
				</div>
			</div>
		</div>
	</header>

	<div class="container page">
		<div class="row">
			<div id="gamePane" class="col-sm-8">
				<h1>Quiz</h1>

				<div id="quizStuff" class="row col-xs-12">
					<h3 id="question"></h3>
					<div id="answers"></div>
				</div>

				<div id="scoreStuff" class="row col-xs-12">
					<h3>Score</h3>
					<div id="tally">0</div>
				</div>
			</div>


			<div id="infoPane" class="col-sm-4">
				<h3>Info about the app</h3>
			</div>



		</div>
	</div>

	<footer>
		<div class="container">
			<div class="row">
				<p class="col-xs-6">Simple <a href="https://github.com/david-ma/Thalia">Thalia</a> Bootstrap Boilerplate</p>
				<p class="col-xs-6 text-right">By <a href="https://twitter.com/frostickle">@Frostickle</a> <i class="fa fa-twitter" aria-hidden="true"></i></p>
			</div>
		</div>
	</footer>
	<link rel="stylesheet" href="/css/main.css">
	<script src="/js/vendor.min.js"></script>
	<script src="/js/scripts.min.js"></script>

	<!--Not sure how to use d3.js v4 and attrs-->
	<!--<script src="/js/d3.min.js"></script>-->
	<!--<script src="/js/d3-selection-multi.v1.min.js"></script>-->




<script>
var score = 0;

newQuestionV1();







function newQuestionV1() {
	$.ajax({
		url: "/v1/newQuestion.json",
		complete: function(response){
			if (response.status && response.status == 200) {
				var data = JSON.parse(response.responseText);
				drawQuestion(data);
			} else {
				console.error(response);
				alert("There was an error");
			}
		}
	});
}

function drawQuestion(data) {
	console.log(data);
	d3.select("#question").text(data.question);
	d3.selectAll("#answers .answer").remove();
	var answers = d3.select("#answers");

	var correctAnswer = data.answers[0];

	shuffle(data.answers).forEach(function(answer){
		answers
			.append("a").classed("answer", true)
				.attr("correctAnswer", correctAnswer)
				.attr('href', '#')
				.text(answer)
			.on("click", checkAnswer);
	});

}

function checkAnswer() {
	console.log("checking answer!");
	console.log(this);
	var correctAnswer = d3.select(this).attr("correctAnswer");
	var answer = d3.select(this).text();
	console.log(correctAnswer);

	if(correctAnswer == answer) {
		score++;
		d3.select("#tally").text(score);
	} else {
		alert("Sorry, the answer was "+correctAnswer);
	}
	d3.select("#quizStuff")
		.transition()
		.style("padding-left", "1000px")
		.on("end", function(d){
			newQuestionV1();
			d3.select("#quizStuff").style("padding-left", "0px");
			console.log("end");
		});


}











//https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array
function shuffle(array) {
	var currentIndex = array.length, temporaryValue, randomIndex;

	// While there remain elements to shuffle...
	while (0 !== currentIndex) {

		// Pick a remaining element...
		randomIndex = Math.floor(Math.random() * currentIndex);
		currentIndex -= 1;

		// And swap it with the current element.
		temporaryValue = array[currentIndex];
		array[currentIndex] = array[randomIndex];
		array[randomIndex] = temporaryValue;
	}

	return array;
}


</script>



</body>
</html>



































































